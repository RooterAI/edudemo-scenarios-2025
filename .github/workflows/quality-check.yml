name: ðŸ“ ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸

on:
  push:
    branches: [ main, master, develop ]
  pull_request:
    branches: [ main, master ]

jobs:
  markdown-lint:
    name: ðŸ” ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Markdown
    runs-on: ubuntu-latest
    
    steps:
    - name: ðŸ“¥ Checkout ÐºÐ¾Ð´Ð°
      uses: actions/checkout@v4
      
    - name: ðŸ”§ ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: ðŸ“¦ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
      run: |
        npm install -g markdownlint-cli2
        npm install -g markdown-link-check
        
    - name: ðŸ“ ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Markdown ÑÐ¸Ð½Ñ‚Ð°ÐºÑÐ¸ÑÐ°
      run: markdownlint-cli2 "**/*.md" "!node_modules"
      continue-on-error: true
      
    - name: ðŸ”— ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑÑ‹Ð»Ð¾Ðº
      run: |
        find . -name "*.md" -not -path "./node_modules/*" | xargs markdown-link-check
      continue-on-error: true

  educational-quality:
    name: ðŸŽ“ ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð°
    runs-on: ubuntu-latest
    
    steps:
    - name: ðŸ“¥ Checkout ÐºÐ¾Ð´Ð°
      uses: actions/checkout@v4
      
    - name: ðŸŽ¯ ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
      run: |
        echo "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²..."
        test -f README.md || { echo "âŒ README.md Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚"; exit 1; }
        test -f Track001.md || { echo "âŒ Track001.md Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚"; exit 1; }
        test -f LICENSE || { echo "âŒ LICENSE Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚"; exit 1; }
        test -f CONTRIBUTING.md || { echo "âŒ CONTRIBUTING.md Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚"; exit 1; }
        echo "âœ… Ð’ÑÐµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð¿Ñ€Ð¸ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‚"
        
    - name: ðŸ“š ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚Ð°
      run: |
        echo "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ñ Ð¤Ð“ÐžÐ¡ Ð¡ÐŸÐž..."
        grep -q "09.02.07" Track001.md || { echo "âš ï¸ ÐÐµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾ ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ðµ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸"; }
        grep -q "ÐžÐš 02\|ÐžÐš 04\|ÐŸÐš 1.1" Track001.md || { echo "âš ï¸ ÐšÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¸ Ð½Ðµ ÑƒÐºÐ°Ð·Ð°Ð½Ñ‹ Ñ‡ÐµÑ‚ÐºÐ¾"; }
        
        echo "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ñ€Ð°Ð¼Ð¾Ðº..."
        grep -q "90 Ð¼Ð¸Ð½ÑƒÑ‚\|2.*Ñ‡Ð°Ñ" Track001.md || { echo "âš ï¸ Ð’Ñ€ÐµÐ¼Ñ Ð·Ð°Ð½ÑÑ‚Ð¸Ñ Ð½Ðµ ÑƒÐºÐ°Ð·Ð°Ð½Ð¾"; }
        
        echo "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸ÐµÐ² Ð¾Ñ†ÐµÐ½Ð¸Ð²Ð°Ð½Ð¸Ñ..."
        grep -q "ÐšÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¸\|Ð¾Ñ†ÐµÐ½Ð¸Ð²Ð°" Track001.md || { echo "âš ï¸ ÐšÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¸ Ð¾Ñ†ÐµÐ½Ð¸Ð²Ð°Ð½Ð¸Ñ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹"; }
        
        echo "âœ… ÐžÐ±Ñ€Ð°Ð·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐµÐ½"

  security-check:
    name: ðŸ”’ ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸
    runs-on: ubuntu-latest
    
    steps:
    - name: ðŸ“¥ Checkout ÐºÐ¾Ð´Ð°
      uses: actions/checkout@v4
      
    - name: ðŸ•µï¸ ÐŸÐ¾Ð¸ÑÐº Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
      run: |
        echo "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…..."
        
        # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° email-Ð°Ð´Ñ€ÐµÑÐ¾Ð² (Ð¸ÑÐºÐ»ÑŽÑ‡Ð°Ñ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹)
        if grep -r "@" --include="*.md" . | grep -v "\[at\]" | grep -v "example\|test\|demo"; then
          echo "âš ï¸ ÐÐ°Ð¹Ð´ÐµÐ½Ñ‹ Ð¿Ð¾Ñ‚ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ email-Ð°Ð´Ñ€ÐµÑÐ°"
        fi
        
        # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð½Ñ‹Ñ… Ð½Ð¾Ð¼ÐµÑ€Ð¾Ð²
        if grep -r "+7\|8(" --include="*.md" . | grep -v "XXX"; then
          echo "âš ï¸ ÐÐ°Ð¹Ð´ÐµÐ½Ñ‹ Ð¿Ð¾Ñ‚ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð½Ð¾Ð¼ÐµÑ€Ð° Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð¾Ð²"
        fi
        
        # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¸Ð¼ÐµÐ½Ð° (Ð±Ð°Ð·Ð¾Ð²Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°)
        if grep -r "Ð˜Ð²Ð°Ð½Ð¾Ð²\|ÐŸÐµÑ‚Ñ€Ð¾Ð²\|Ð¡Ð¸Ð´Ð¾Ñ€Ð¾Ð²" --include="*.md" .; then
          echo "âš ï¸ ÐÐ°Ð¹Ð´ÐµÐ½Ñ‹ Ð¿Ð¾Ñ‚ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¸Ð¼ÐµÐ½Ð°"
        fi
        
        echo "âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°"

  build-preview:
    name: ðŸ“– Ð¡Ð±Ð¾Ñ€ÐºÐ° Ð¿Ñ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°
    runs-on: ubuntu-latest
    
    steps:
    - name: ðŸ“¥ Checkout ÐºÐ¾Ð´Ð°
      uses: actions/checkout@v4
      
    - name: ðŸ”§ ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'
        
    - name: ðŸ“¦ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° MkDocs
      run: |
        pip install mkdocs mkdocs-material
        
    - name: ðŸ“„ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ MkDocs
      run: |
        cat > mkdocs.yml << 'EOF'
        site_name: ÐœÐµÑ‚Ð¾Ð´Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Master AI ÐšÐ¾Ð»Ð»ÐµÐ´Ð¶
        site_description: ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŒÐ½Ð¾Ðµ Ð·Ð°Ð½ÑÑ‚Ð¸Ðµ Ð¿Ð¾ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸ÐºÐµ Ð´Ð»Ñ IT-ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÐµÐ¹
        
        theme:
          name: material
          language: ru
          features:
            - navigation.tabs
            - navigation.sections
            - toc.integrate
          palette:
            - scheme: default
              primary: blue
              accent: orange
        
        nav:
          - 'Ð“Ð»Ð°Ð²Ð½Ð°Ñ': 'README.md'
          - 'ÐŸÐ»Ð°Ð½ Ð·Ð°Ð½ÑÑ‚Ð¸Ñ': 'Track001.md'
          - 'Ð£Ñ‡Ð°ÑÑ‚Ð¸Ðµ':
            - 'ÐšÐ°Ðº ÑƒÑ‡Ð°ÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ': 'CONTRIBUTING.md'
            - 'ÐšÐ¾Ð´ÐµÐºÑ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ': 'CODE_OF_CONDUCT.md'
          - 'Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ': 'CHANGELOG.md'
          
        markdown_extensions:
          - tables
          - toc:
              permalink: true
          - pymdownx.emoji:
              emoji_index: !!python/name:materialx.emoji.twemoji
              emoji_generator: !!python/name:materialx.emoji.to_svg
        EOF
        
    - name: ðŸ—ï¸ Ð¡Ð±Ð¾Ñ€ÐºÐ° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸
      run: mkdocs build
      
    - name: ðŸ“¤ Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð°Ñ€Ñ‚ÐµÑ„Ð°ÐºÑ‚Ð°
      uses: actions/upload-artifact@v3
      with:
        name: documentation-site
        path: site/

  notify-completion:
    name: ðŸ”” Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ð¸
    runs-on: ubuntu-latest
    needs: [markdown-lint, educational-quality, security-check, build-preview]
    if: always()
    
    steps:
    - name: ðŸ“Š Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°
      run: |
        echo "# ðŸ“‹ ÐžÑ‚Ñ‡ÐµÑ‚ Ð¾ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐµ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð°" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "## ðŸ“ Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¾Ðº" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "- **Markdown lint**: ${{ needs.markdown-lint.result == 'success' && 'âœ… ÐŸÑ€Ð¾Ð¹Ð´ÐµÐ½Ð¾' || 'âŒ ÐžÑˆÐ¸Ð±ÐºÐ¸' }}" >> $GITHUB_STEP_SUMMARY
        echo "- **ÐžÐ±Ñ€Ð°Ð·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð¾**: ${{ needs.educational-quality.result == 'success' && 'âœ… ÐŸÑ€Ð¾Ð¹Ð´ÐµÐ½Ð¾' || 'âŒ ÐžÑˆÐ¸Ð±ÐºÐ¸' }}" >> $GITHUB_STEP_SUMMARY
        echo "- **Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ**: ${{ needs.security-check.result == 'success' && 'âœ… ÐŸÑ€Ð¾Ð¹Ð´ÐµÐ½Ð¾' || 'âŒ ÐžÑˆÐ¸Ð±ÐºÐ¸' }}" >> $GITHUB_STEP_SUMMARY
        echo "- **Ð¡Ð±Ð¾Ñ€ÐºÐ° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸**: ${{ needs.build-preview.result == 'success' && 'âœ… ÐŸÑ€Ð¾Ð¹Ð´ÐµÐ½Ð¾' || 'âŒ ÐžÑˆÐ¸Ð±ÐºÐ¸' }}" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "## ðŸŽ¯ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "- Ð’ÑÐµ markdown Ñ„Ð°Ð¹Ð»Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð°Ð¼ Ð»Ð¸Ð½Ñ‚ÐµÑ€Ð°" >> $GITHUB_STEP_SUMMARY
        echo "- ÐžÐ±Ñ€Ð°Ð·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð²ÐºÐ»ÑŽÑ‡Ð°Ñ‚ÑŒ Ð¤Ð“ÐžÐ¡, ÐºÐ¾Ð¼Ð¿ÐµÑ‚ÐµÐ½Ñ†Ð¸Ð¸ Ð¸ ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¸" >> $GITHUB_STEP_SUMMARY
        echo "- ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ Ð¾Ð±ÐµÐ·Ð»Ð¸Ñ‡ÐµÐ½Ñ‹" >> $GITHUB_STEP_SUMMARY
        echo "- Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð´Ð¾Ð»Ð¶Ð½Ð° ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑÐ¾Ð±Ð¸Ñ€Ð°Ñ‚ÑŒÑÑ Ð² ÑÑ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ ÑÐ°Ð¹Ñ‚" >> $GITHUB_STEP_SUMMARY